---
format: live-html
engine: knitr
lightbox: true
webr:
  resources:
    - https://raw.githubusercontent.com/LizzieWadsworth/Level-4-R-course-book/refs/heads/main/Datasets/heart.csv
  packages:
    - ggplot2
    - dplyr
    - ggpubr
---

{{< include /_extensions/r-wasm/live/_knitr.qmd >}}

# Annotate the R and p values onto the scatter graph

To annotate our R and p values onto a scatter graph, we can use the `stat_cor` function from the `ggpubr` package.

If you've not already installed it, make sure that first you install it in the console using:

`install.packages('ggpubr')`

```{r}
#| eval: false
# Load ggplot2 AND ggpubr packages
library(ggplot2)
library(ggpubr)

# Open heart.csv and save as a dataframe
heart_df <- read.csv("heart.csv") 

# Plot the heart data as before
ggplot(heart_df, aes(x = age, y = restbp)) +
  geom_point() +
  # add a pearson correlation from the stat_cor function
  stat_cor(method = 'pearson') 
```

```{r}
#| echo: false
# Load ggplot2 AND ggpubr packages
library(ggplot2)
library(ggpubr)

# Open heart.csv and save as a dataframe
heart_df <- read.csv("../Datasets/heart.csv") 

# Plot the heart data as before
ggplot(heart_df, aes(x = age, y = restbp)) +
  geom_point() +
  # add a pearson correlation from the stat_cor function
  stat_cor(method = 'pearson') 
```

The only parameter we used here for `stat_cor` was `method = 'pearson'` so that it would plot a pearson's correlation.

::: {.callout-note title="Question" collapse="false"}
Do the R and p values annotated on this graph match the results from `cor.test()`?
:::

## Moving the R and P values

We can use parameters `label.x` and `label.y` to add co-ordinates for where we want the R and p value annotations to go.

Try it below:

```{webr}
#| exercise: ex_1
# Open heart.csv and save as a dataframe
heart_df <- read.csv("heart.csv") 

# Plot the heart data as before
ggplot(heart_df, aes(x = age, y = restbp)) +
  geom_point() +
  # add a pearson correlation from the stat_cor function
  stat_cor(method = 'pearson', label.x = ______, label.y = ______)
```

::: {.callout-tip collapse="false"}
If you'd like the R and p value to each be on their own line, we can add `label.sep = '\n'` which adds a **`\n` newline character**

*What happens if you add `label.sep = 'HELLO'`?*
:::